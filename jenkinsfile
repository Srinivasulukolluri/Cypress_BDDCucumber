pipeline{


agent any
parameters{
    string (name:'spec',defaultValue:"cypress/e2e/newtours/newtours.feature", description:"Eneter the script path that you want to execute")
    choice (name:"BROWSER",choices:['chrome','safari','edge','firefox'], description:"Choice the browser where you want to execute your scripts")
   
}
options{

    ansiColor('xterm')
}
stages{
stage('Building'){
    steps{
    echo "Building the Application"
    }
}
stage('Testing'){
    steps{
        sh "npn i"
        sh "npx cypress run --browser ${BROWSER} --spec ${spec}"
    }
}
stage('Deploying'){
    steps{
    echo "Diploy the application"
    }
}
post{

    always{
    publishHTML([
    reportName: 'Newman Report'
    reportDir: 'cypress/reports',
    reportFiles: "${dir('cypress/reports') { findFiles(glob: '**/*.html').join(',') ?: 'Not found' }}",
    allowMissing: true,
    alwaysLinkToLastBuild: true,
    keepAll: true,
])
    }
}

}

}